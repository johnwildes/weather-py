{% extends "base.html" %}
{% block title %}Weather Forecast{% endblock %}

{% block content %}
<div class="forecast-content" id="forecastContent">
    {% if error_message %}
    <!-- Error Message Display -->
    <div class="error-state">
        <fluent-card class="error-card">
            <div class="error-content">
                <div class="error-icon">‚ö†Ô∏è</div>
                <h3>Error Loading Weather Data</h3>
                <p>{{ error_message }}</p>
            </div>
        </fluent-card>
    </div>
    {% elif weather_data %}
    <!-- Current Weather Display -->
    <div class="current-weather-section">
        <fluent-card class="current-weather-card">
            <div class="current-weather-header">
                <div class="location-info">
                    <h2 class="city-name">{{ weather_data.location.name }}</h2>
                    <p class="region-country">{{ weather_data.location.region }}{% if weather_data.location.region and weather_data.location.country %}, {% endif %}{{ weather_data.location.country }}</p>
                </div>
                <div class="current-temp-display">
                    <img src="https:{{ weather_data.current.condition.icon }}" 
                         alt="{{ weather_data.current.condition.text }}" 
                         class="current-condition-icon" />
                    <span class="current-temp">{{ weather_data.current.temp_c }}¬∞C</span>
                </div>
            </div>
            <div class="current-weather-details">
                <p class="condition-text">{{ weather_data.current.condition.text }}</p>
                <div class="weather-stats">
                    <div class="stat-item">
                        <span class="stat-label">Feels like</span>
                        <span class="stat-value">{{ weather_data.current.feelslike_c }}¬∞C</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Humidity</span>
                        <span class="stat-value">{{ weather_data.current.humidity }}%</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Wind</span>
                        <span class="stat-value">{{ weather_data.current.wind_kph }} km/h</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Visibility</span>
                        <span class="stat-value">{{ weather_data.current.vis_km }} km</span>
                    </div>
                </div>
            </div>
        </fluent-card>
    </div>

    <!-- 10-Day Forecast Section -->
    {% if weather_data.forecast and weather_data.forecast.forecastday %}
    <div class="forecast-section">
        <fluent-card class="forecast-card">
            <h3 class="forecast-title">10-Day Forecast</h3>
            <div class="forecast-list">
                {% for day in weather_data.forecast.forecastday %}
                <div class="forecast-day-row">
                    <div class="day-info">
                        <span class="day-name">{{ day.date | format_date }}</span>
                        <span class="day-date">{{ day.date }}</span>
                    </div>
                    <div class="day-condition">
                        <img src="https:{{ day.day.condition.icon }}" 
                             alt="{{ day.day.condition.text }}" 
                             class="forecast-icon" />
                        <span class="condition-text">{{ day.day.condition.text }}</span>
                    </div>
                    <div class="day-temps">
                        <span class="temp-high">{{ day.day.maxtemp_c }}¬∞</span>
                        <div class="temp-bar">
                            {% set temp_width = ((day.day.maxtemp_c - day.day.mintemp_c) / 30 * 100)|int %}
                            <div class="temp-bar-fill" style="width: {{ [[temp_width, 0]|max, 100]|min }}%;"></div>
                        </div>
                        <span class="temp-low">{{ day.day.mintemp_c }}¬∞</span>
                    </div>
                    <div class="day-rain">
                        {% if day.day.daily_chance_of_rain > 0 %}
                        <span class="rain-chance">{{ day.day.daily_chance_of_rain }}%</span>
                        {% endif %}
                    </div>
                </div>
                {% endfor %}
            </div>
        </fluent-card>
    </div>
    {% endif %}
    {% else %}
    <!-- Empty State -->
    <div class="empty-state">
        <fluent-card class="empty-card">
            <div class="empty-content">
                <div class="empty-icon">üå§Ô∏è</div>
                <h3>Search for a location</h3>
                <p>Enter a city name or zip code above to see the weather forecast.</p>
            </div>
        </fluent-card>
    </div>
    {% endif %}
</div>
{% endblock %}
